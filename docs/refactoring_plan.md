# RiskWatch 리팩토링 계획

## 현재 아키텍처 분석

### 복잡성 요인
1. 다수의 마이크로서비스 (8개 이상)
2. 복잡한 네트워크 설정
3. 중복된 환경 변수
4. 과도한 리소스 할당
5. 세분화된 서비스 분리

## 리팩토링 목표

### 1. 아키텍처 단순화
- 마이크로서비스 통합
- 공통 설정 표준화
- 불필요한 서비스 제거

### 2. 리소스 최적화
- 메모리 사용량 감소
- CPU 오버헤드 최소화
- 컨테이너 시작 시간 단축

### 3. 유지보수성 개선
- 설정 파일 간소화
- 환경 변수 통합
- 도커 컴포즈 구조 개선

## 세부 리팩토링 전략

### 서비스 통합 및 제거
- `news_collector`와 `news_storage` 통합
- `jupyter` 서비스 제거 (개발 환경으로 이동->간단한 작업)

### 네트워킹 단순화
- 단일 네트워크로 통합
- 불필요한 포트 매핑 제거
- 서비스 간 통신 최적화

### 환경 설정 개선
- 공통 환경 변수 `.env` 파일로 통합
- 민감한 정보는 시크릿 관리 시스템 도입
- 기본값 표준화

### 리소스 할당 최적화
- 메모리 제한 조정
- 불필요한 리소스 예약 제거
- 컨테이너 재시작 정책 개선

### 개발/운영 환경 분리
- 개발 전용 도커 컴포즈 파일 생성
- 프로덕션 특화 설정 분리
- 환경별 다른 설정 지원

## 구체적인 개선 방안

### 1. 서비스 통합
```yaml
services:
  news_service:
    build: 
      context: .
      dockerfile: Dockerfile.news_service
    environment:
      # 통합된 환경 변수
    volumes:
      # 최소한의 볼륨 마운트
```

### 2. 네트워크 단순화
```yaml
networks:
  default:
    driver: bridge
```

### 3. 리소스 최적화
```yaml
services:
  news_service:
    deploy:
      resources:
        limits:
          memory: 512M
        reservations:
          memory: 256M
```

## 마이그레이션 로드맵

1. 현재 시스템 기능 분석
2. 서비스 통합 아키텍처 설계
3. 점진적 리팩토링
   - 단위 테스트 작성
   - 서비스 통합
   - 성능 검증
4. 새로운 아키텍처 검증
5. 프로덕션 마이그레이션

## 예상 이점
- 시스템 복잡도 50% 감소
- 리소스 사용량 30% 절감
- 유지보수성 향상
- 개발 및 배포 속도 개선

## 주의사항
- 기존 기능의 완전한 보존
- 점진적 접근
- 지속적인 성능 모니터링
